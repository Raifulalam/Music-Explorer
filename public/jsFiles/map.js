const singersByState = {
    "Andhra Pradesh": [
        { name: "S. P. Balasubrahmanyam", image: "./PopularSinger/SPB.avif" },
        { name: "K. S. Chithra", image: "./PopularSinger/ks-chithra.jpg" },
        { name: "Hariharan", image: "./PopularSinger/Hariharan.jpg" },
        { name: "M. M. Keeravani", image: "./PopularSinger/Kailash Kher.jpg" }
    ],
    "Arunachal Pradesh": [
        { name: "Taba Chake", image: "./PopularSinger/images.jpg" },
    ],
    "Assam": [
        { name: "Zubeen Garg", image: "./PopularSinger/Zubeen Garg.png" },
        { name: "Papon", image: "./PopularSinger/Papon.jpg" },
    ],
    "Bihar": [
        { name: "Udit Narayan", image: "./PopularSinger/Udit Narayan.jpg" },
        { name: "Sharda Sinha", image: "./PopularSinger/sharda-sinha.jpg" },
        { name: "Khesari Lal Yadav", image: "./PopularSinger/Khesari.jpg" },
        { name: "Pawan Singh", image: "./PopularSinger/pawan.avif" }
    ],
    "Chhattisgarh": [
        { name: "Teejan Bai", image: "./PopularSinger/Teejanbai.webp" },
        { name: "Pooja Sethi", image: "./PopularSinger/Pooja Sethi.jpg" },
    ],
    "Goa": [
        { name: "Chris Perry", image: "./PopularSinger/Chris Perry.webp" },
    ],
    "Gujarat": [

        { name: "Falguni Pathak", image: "./PopularSinger/Falguni Pathak.cms" },
        { name: "Kirtidan Gadhvi", image: "./PopularSinger/Kirtidan Gadhvi.webp" },
        { name: "Aishwarya Majmudar", image: "./PopularSinger/Aishwarya Majmudar.webp" }
    ],
    "Haryana": [
        { name: "Sapna Choudhary", image: "./PopularSinger/sapna.avif" },
        { name: "Diler Kharkiya", image: "./PopularSinger/Diler Kharkiya.jpg" },
        { name: "Raj Mawar", image: "./PopularSinger/Raj Mawar.jpg" },

    ],
    "Himachal Pradesh": [
        { name: "Neha Kakkar", image: "./PopularSinger/Neha Kakkar.jpg" },

    ],
    "Jharkhand": [

        { name: "Madhusree", image: "./PopularSinger/Madhusree.jpg" }
    ],
    "Karnataka": [
        { name: "K. S. Chithra", image: "./PopularSinger/ks-chithra.jpg" },
        { name: "Vani Jairam", image: "./PopularSinger/Vani Jairam.jpg" },

    ],
    "Kerala": [
        { name: "K. J. Yesudas", image: "./PopularSinger/Hariharan.jpg" },
        { name: "Chitra", image: "./PopularSinger/ks-chithra.jpg" },
        { name: "M. G. Sreekumar", image: "./PopularSinger/M. G. Sreekumar.cms" },
        { name: "Sujatha Mohan", image: "./PopularSinger/Sujatha-Mohan.jpg" }
    ],
    "Ladakh": [
        { name: "Sonam Wangmo", image: "./PopularSinger/Sonam Wangmo" },
        { name: "Tsering Wangmo", image: "./PopularSinger/wangmo_tsering.jpg" },
        { name: "Lobsang Wangyal", image: "./PopularSinger/Lobsang Wangyal.jpg" }
    ],
    "Lakshadweep": [
        { name: "Suman Kalyanpur", image: "./PopularSinger/Suman Kalyanpur.jpg" },
    ],
    "Delhi": [
        { name: "Sunidhi Chauhan", image: "./PopularSinger/Sunidhi Chauhan.jpg" },
        { name: "Badshah", image: "./PopularSinger/Badshah.webp" },
        { name: "Amit Trivedi", image: "./PopularSinger/Amit Trivedi.webp" },
        { name: "Ritviz", image: "./PopularSinger/Ritviz.webp" }
    ],
    "Puducherry": [
        { name: "Karthik", image: "./PopularSinger/Kailash Kher.jpg" },
        { name: "Shalini", image: "./PopularSinger/Shalini.jpg" }
    ],
    "Maharashtra": [
        { name: "Lata Mangeshkar", image: "./PopularSinger/Lata Mangeshkar.jpg" },
        { name: "Asha Bhosle", image: "./PopularSinger/Asha Bhosle.webp" },
        { name: "Kishore Kumar", image: "./PopularSinger/Kishore Kumar.jpg" },
        { name: "Mohammad Rafi", image: "./PopularSinger/Rafi.avif" },
        { name: "Sonu Nigam", image: "./PopularSinger/Sonu Nigam.webp" },
        { name: "Shreya Ghoshal", image: "./PopularSinger/Shreya-Ghoshal5-scaled.jpg" },
        { name: "Sukhwinder Singh", image: "./PopularSinger/Sukhwinder_Singh_Press_Image_2__1_.jpg" },

    ],
    "Manipur": [
        { name: "Sanjay Leela Bhansali", image: "./PopularSinger/Sanjay Leela Bhansali.webp" },
    ],

    "Mizoram": [
        { name: "Lalmuansangi", image: "./PopularSinger/Lalmuansangi.webp" },
    ],
    "Nagaland": [
        { name: "Theja Meru", image: "./PopularSinger/Theja Meru.jpg" },
        { name: "Tali Angh", image: "./PopularSinger/Tali Angh.jpg" },
    ],
    "Tamil Nadu": [
        { name: "A. R. Rahman", image: "./PopularSinger/A. R. Rahman.jpg" },
        { name: "K. S. Chithra", image: "./PopularSinger/ks-chithra.jpg" },
        { name: "Chinmayi", image: "./PopularSinger/Chinmayi.avif" },
    ],
    "Telangana": [
        { name: "S. P. Balasubrahmanyam", image: "./PopularSinger/SPB.avif" },
        { name: "K. S. Chithra", image: "./PopularSinger/ks-chithra.jpg" },
        { name: "Hariharan", image: "./PopularSinger/Hariharan.jpg" },
        { name: "Kailash Kher", image: "./PopularSinger/Kailash Kher.jpg" }
    ],
    "Uttar Pradesh": [
        { name: "Shubha Mudgal", image: "./PopularSinger/Shubha Mudgal.jpg" },
        { name: "Jubin Nautiyal", image: "./PopularSinger/Hariharan.jpg" },
        { name: "Kabita Seth", image: "./PopularSinger/Kabita Seth.jpg" },
        { name: "Mohammad Rafi", image: "./PopularSinger/Rafi.avif" }
    ],
    "Uttarakhand": [
        { name: "Meena Rana", image: "./PopularSinger/Meena Rana.jpg" },
        { name: "Kishore Kumar", image: "./PopularSinger/Kishore Kumar.jpg" },
        { name: "Anita Rao", image: "./PopularSinger/Anita Rao.jpg" }
    ],
    "West Bengal": [
        { name: "Arijit Singh", image: "./PopularSinger/Arijit Singh.webp" },
        { name: "Shreya Ghoshal", image: "./PopularSinger/Shreya-Ghoshal5-scaled.jpg" },
        { name: "Kishore Kumar", image: "./PopularSinger/Kishore Kumar.jpg" }
    ]
};


const visited = []


// Example of accessing singers from a specific state
console.log(singersByState["West Bengal"]); // Output: ["Arijit Singh", "Shreya Ghoshal"]


if (navigator.geolocation) {
    navigator.geolocation.getCurrentPosition(function (position) {
        let userLocation = [position.coords.latitude, position.coords.longitude];
        console.log(userLocation)
        document.getElementById("lat").innerHTML = `${userLocation[0]}`;
        document.getElementById("lng").innerHTML = `${userLocation[1]}`;

        // Set the map view to the user's location
        map.setView(userLocation, 12);

        // Add a marker at the user's location
        let marker = L.marker(userLocation).addTo(map)
            .bindPopup('Your Location')
            .openPopup();

        // Reverse geocoding to get the address
        let geocodeAPI = 'https://nominatim.openstreetmap.org/reverse?format=json&lat=' + userLocation[0] + '&lon=' + userLocation[1];
        fetch(geocodeAPI)
            .then(response => response.json())
            .then(data => {

                document.querySelector('.para').innerHTML = 'Address: ' + data.display_name;
                // findSinger()
                displaySingers()
            })
            .catch(error => console.log('Error fetching address:', error));
    }, function () {
        handleLocationError(true, defaultLocation);
    });
} else {
    // Browser doesn't support Geolocation
    handleLocationError(false, defaultLocation);
}


// Default coordinates (if geolocation fails)
let defaultLocation = [28.7041, 77.1025];; // delhi

// Create a map centered at the default location
let map = L.map('map').setView(defaultLocation, 12);

// Add a tile layer from OpenStreetMap
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
}).addTo(map);


// Listen for click events on the map
let lat;
let lng;
let clicked = [];

map.on('click', function (e) {
    lat = e.latlng.lat;
    lng = e.latlng.lng;
    const details = `${lat}, ${lng} `;
    clicked.push(details);
    clicked.forEach(element => {
        document.getElementById("lat").innerHTML = `${lat}`;
        document.getElementById("lng").innerHTML = `${lng}`;
        // document.querySelector('.para').innerHTML = `Clicked at:${element}`;
    });
    // Create a marker at the clicked location
    let marker = L.marker([lat, lng]).addTo(map);

    // Reverse geocoding to get the address
    let geocodeAPI = 'https://nominatim.openstreetmap.org/reverse?format=json&lat=' + lat + '&lon=' + lng;

    fetch(geocodeAPI)
        .then(response => response.json())
        .then(data => {
            let address = data.display_name;
            visited.push(address);
            console.log(visited)
            const stateName = address.trim().toLowerCase().split(',');
            const latestVisited = document.getElementById('visited');
            latestVisited.innerHTML += `<p>${address}</p>`

            const states = Object.keys(singersByState);

            document.querySelector('.para').innerHTML = 'Address: ' + address;
            // findSinger();
            displaySingers()

        })
        .catch(error => console.error(error));

});
const result = document.getElementById('result');

// function findSinger() {
//     result.innerHTML = '';
//     const stateName = document.querySelector('.para').innerHTML.trim().toLowerCase().split(',');
//     const states = Object.keys(singersByState);
//     stateName.forEach((e) => {
//         let name = e.trim();
//         const matchingStates = states.filter(state => state.toLowerCase().includes(name));
//         console.log(matchingStates);
//         SingerName = (singersByState[matchingStates[0]]);
//         if (matchingStates.length > 0) {
//             SingerName.forEach((e, index) => {
//                 result.innerHTML += `
//                 <ul>
//                 <li class="singer-name">
//                 <img src="${e.imges}" alt="singer-image">
//                         ${SingerName[index]}
//                 </li>
//                 </ul>
//                 `
//             })
//         }
//     });
// }

function displaySingers() {
    result.innerHTML = '';
    const stateName = document.querySelector('.para').innerHTML.trim().toLowerCase().split(',');
    const states = Object.keys(singersByState);
    stateName.forEach((e) => {
        let name = e.trim();
        const matchingStates = states.filter(state => state.toLowerCase().includes(name));
        console.log(matchingStates);

        const singers = singersByState[matchingStates];
        console.log(singers)
        if (matchingStates.length > 0) {
            singers.forEach((singer) => {
                const singerDiv = document.createElement('div');
                singerDiv.classList.add('singer');

                const image = document.createElement('img');
                image.src = singer.image;
                image.alt = singer.name;

                const name = document.createElement('h4');
                name.textContent = singer.name;



                singerDiv.appendChild(image);
                singerDiv.appendChild(name);

                result.appendChild(singerDiv)
            })
        }

        // result.innerHTML = '<p>No singers found for this state.</p>';
        // return;
    })
}